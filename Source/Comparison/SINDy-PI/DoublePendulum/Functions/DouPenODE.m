function dydt=DouPenODE(t,y,m1,m2,L1,L2,g)

q1 = y(1,:);
q2 = y(2,:);
q1_t = y(3,:);
q2_t = y(4,:);
q1_2t = (-L1.*g.*m1.*sin(q1) - L1.*g.*m2.*sin(q1) + 0 + m2.*(2.*L1.*(L1.*sin(q1).*q1_t + L2.*sin(q2).*q2_t).*cos(q1).*q1_t - 2.*L1.*(L1.*cos(q1).*q1_t + L2.*cos(q2).*q2_t).*sin(q1).*q1_t)./2 - m2.*(2.*L1.*(L1.*sin(q1).*q1_t + L2.*sin(q2).*q2_t).*cos(q1).*q1_t + 2.*L1.*(-L1.*sin(q1).*q1_t.^2 - L2.*sin(q2).*q2_t.^2).*cos(q1) - 2.*L1.*(L1.*cos(q1).*q1_t + L2.*cos(q2).*q2_t).*sin(q1).*q1_t + 2.*L1.*(L1.*cos(q1).*q1_t.^2 + L2.*cos(q2).*q2_t.^2).*sin(q1))./2 - m2.*(2.*L1.*L2.*sin(q1).*sin(q2) + 2.*L1.*L2.*cos(q1).*cos(q2)).*(-L2.*g.*m2.*sin(q2) + m2.*(2.*L2.*(L1.*sin(q1).*q1_t + L2.*sin(q2).*q2_t).*cos(q2).*q2_t - 2.*L2.*(L1.*cos(q1).*q1_t + L2.*cos(q2).*q2_t).*sin(q2).*q2_t)./2 - m2.*(2.*L2.*(L1.*sin(q1).*q1_t + L2.*sin(q2).*q2_t).*cos(q2).*q2_t + 2.*L2.*(-L1.*sin(q1).*q1_t.^2 - L2.*sin(q2).*q2_t.^2).*cos(q2) - 2.*L2.*(L1.*cos(q1).*q1_t + L2.*cos(q2).*q2_t).*sin(q2).*q2_t + 2.*L2.*(L1.*cos(q1).*q1_t.^2 + L2.*cos(q2).*q2_t.^2).*sin(q2))./2 - m2.*(2.*L1.*L2.*sin(q1).*sin(q2) + 2.*L1.*L2.*cos(q1).*cos(q2)).*(-L1.*g.*m1.*sin(q1) - L1.*g.*m2.*sin(q1) + 0 + m2.*(2.*L1.*(L1.*sin(q1).*q1_t + L2.*sin(q2).*q2_t).*cos(q1).*q1_t - 2.*L1.*(L1.*cos(q1).*q1_t + L2.*cos(q2).*q2_t).*sin(q1).*q1_t)./2 - m2.*(2.*L1.*(L1.*sin(q1).*q1_t + L2.*sin(q2).*q2_t).*cos(q1).*q1_t + 2.*L1.*(-L1.*sin(q1).*q1_t.^2 - L2.*sin(q2).*q2_t.^2).*cos(q1) - 2.*L1.*(L1.*cos(q1).*q1_t + L2.*cos(q2).*q2_t).*sin(q1).*q1_t + 2.*L1.*(L1.*cos(q1).*q1_t.^2 + L2.*cos(q2).*q2_t.^2).*sin(q1))./2)./(2.*(m1.*(2.*L1.^2.*sin(q1).^2 + 2.*L1.^2.*cos(q1).^2)./2 + m2.*(2.*L1.^2.*sin(q1).^2 + 2.*L1.^2.*cos(q1).^2)./2)))./(2.*(-m2.^2.*(2.*L1.*L2.*sin(q1).*sin(q2) + 2.*L1.*L2.*cos(q1).*cos(q2)).^2./(4.*(m1.*(2.*L1.^2.*sin(q1).^2 + 2.*L1.^2.*cos(q1).^2)./2 + m2.*(2.*L1.^2.*sin(q1).^2 + 2.*L1.^2.*cos(q1).^2)./2)) + m2.*(2.*L2.^2.*sin(q2).^2 + 2.*L2.^2.*cos(q2).^2)./2)))./(m1.*(2.*L1.^2.*sin(q1).^2 + 2.*L1.^2.*cos(q1).^2)./2 + m2.*(2.*L1.^2.*sin(q1).^2 + 2.*L1.^2.*cos(q1).^2)./2);
q2_2t = (-L2.*g.*m2.*sin(q2) + m2.*(2.*L2.*(L1.*sin(q1).*q1_t + L2.*sin(q2).*q2_t).*cos(q2).*q2_t - 2.*L2.*(L1.*cos(q1).*q1_t + L2.*cos(q2).*q2_t).*sin(q2).*q2_t)./2 - m2.*(2.*L2.*(L1.*sin(q1).*q1_t + L2.*sin(q2).*q2_t).*cos(q2).*q2_t + 2.*L2.*(-L1.*sin(q1).*q1_t.^2 - L2.*sin(q2).*q2_t.^2).*cos(q2) - 2.*L2.*(L1.*cos(q1).*q1_t + L2.*cos(q2).*q2_t).*sin(q2).*q2_t + 2.*L2.*(L1.*cos(q1).*q1_t.^2 + L2.*cos(q2).*q2_t.^2).*sin(q2))./2 - m2.*(2.*L1.*L2.*sin(q1).*sin(q2) + 2.*L1.*L2.*cos(q1).*cos(q2)).*(-L1.*g.*m1.*sin(q1) - L1.*g.*m2.*sin(q1) + 0 + m2.*(2.*L1.*(L1.*sin(q1).*q1_t + L2.*sin(q2).*q2_t).*cos(q1).*q1_t - 2.*L1.*(L1.*cos(q1).*q1_t + L2.*cos(q2).*q2_t).*sin(q1).*q1_t)./2 - m2.*(2.*L1.*(L1.*sin(q1).*q1_t + L2.*sin(q2).*q2_t).*cos(q1).*q1_t + 2.*L1.*(-L1.*sin(q1).*q1_t.^2 - L2.*sin(q2).*q2_t.^2).*cos(q1) - 2.*L1.*(L1.*cos(q1).*q1_t + L2.*cos(q2).*q2_t).*sin(q1).*q1_t + 2.*L1.*(L1.*cos(q1).*q1_t.^2 + L2.*cos(q2).*q2_t.^2).*sin(q1))./2)./(2.*(m1.*(2.*L1.^2.*sin(q1).^2 + 2.*L1.^2.*cos(q1).^2)./2 + m2.*(2.*L1.^2.*sin(q1).^2 + 2.*L1.^2.*cos(q1).^2)./2)))./(-m2.^2.*(2.*L1.*L2.*sin(q1).*sin(q2) + 2.*L1.*L2.*cos(q1).*cos(q2)).^2./(4.*(m1.*(2.*L1.^2.*sin(q1).^2 + 2.*L1.^2.*cos(q1).^2)./2 + m2.*(2.*L1.^2.*sin(q1).^2 + 2.*L1.^2.*cos(q1).^2)./2)) + m2.*(2.*L2.^2.*sin(q2).^2 + 2.*L2.^2.*cos(q2).^2)./2);

dydt=[
    q1_t;
    q2_t;
    q1_2t;
    q2_2t];
